import { isReactive, isRef, isShallow, toRaw } from "vue";
import { definePayloadReducer } from "#app/composables/payload";
import { isNuxtError } from "#app/composables/error";
import { defineNuxtPlugin } from "#app/nuxt";
const reducers = {
  NuxtError: (data) => isNuxtError(data) && data.toJSON(),
  EmptyShallowRef: (data) => isRef(data) && isShallow(data) && !data.value && JSON.stringify(data.value),
  EmptyRef: (data) => isRef(data) && !data.value && JSON.stringify(data.value),
  ShallowRef: (data) => isRef(data) && isShallow(data) && data.value,
  ShallowReactive: (data) => isReactive(data) && isShallow(data) && toRaw(data),
  Ref: (data) => isRef(data) && data.value,
  Reactive: (data) => isReactive(data) && toRaw(data)
};
export default defineNuxtPlugin({
  name: "nuxt:revive-payload:server",
  setup() {
    for (const reducer in reducers) {
      definePayloadReducer(reducer, reducers[reducer]);
    }
  }
});
